version: "3"

set: [errexit, pipefail]

tasks:
  default:
    desc: List available tasks
    cmds:
      - task --list

  install:
    desc: Install dependencies
    cmds:
      - pnpm install

  build:
    desc: Build the package
    cmds:
      - pnpm tsup

  dev:
    desc: Build in watch mode
    cmds:
      - pnpm tsup --watch

  test:
    desc: Run tests
    cmds:
      - pnpm vitest run {{.CLI_ARGS}}

  test:watch:
    desc: Run tests in watch mode
    cmds:
      - pnpm vitest {{.CLI_ARGS}}

  lint:
    desc: Type-check with TypeScript
    cmds:
      - pnpm tsc --noEmit

  ci:
    desc: Run full CI pipeline (lint + test + build)
    cmds:
      - task: lint
      - task: test
      - task: build
